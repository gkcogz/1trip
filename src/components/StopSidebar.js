var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
import { Field, EmojiButton } from './ui';
import { useI18n } from '../i18n';
export default function StopSidebar(_a) {
    var trip = _a.trip, selectedStopId = _a.selectedStopId, setSelectedStopId = _a.setSelectedStopId, addActivity = _a.addActivity, setActivityField = _a.setActivityField, deleteActivity = _a.deleteActivity, setStopField = _a.setStopField;
    var t = useI18n().t;
    var stop = trip.stops.find(function (s) { return s.id === selectedStopId; });
    return (_jsxs(_Fragment, { children: [stop && (_jsx("div", { className: "fixed inset-0 bg-black/40 backdrop-blur-[2px] z-40", onClick: function () { return setSelectedStopId(null); } })), _jsxs("div", { className: "fixed inset-y-0 right-0 w-[420px] max-w-[90vw] bg-white border-l border-[var(--color-border)] shadow-2xl transition-transform duration-300 z-50 ".concat(stop ? 'translate-x-0' : 'translate-x-full'), children: [_jsxs("div", { className: "p-4 flex items-center justify-between border-b border-[var(--color-border)]", children: [_jsx("div", { className: "font-semibold text-[var(--color-brand)]", children: t('sidebar.title') }), _jsx(EmojiButton, { emoji: "\u2716\uFE0F", label: t('common.close'), title: t('common.close'), onClick: function () { return setSelectedStopId(null); }, variant: "ghost" })] }), stop && (_jsxs("div", { className: "p-4 md:p-6 space-y-6 overflow-y-auto h-[calc(100%-56px)]", children: [_jsxs("div", { className: "space-y-1", children: [_jsx("div", { className: "text-sm text-[var(--color-muted)]", children: t('sidebar.selected') }), _jsx("div", { className: "text-lg font-semibold text-[var(--color-accent)]", children: stop.city || t('sidebar.untitled') })] }), _jsxs("section", { children: [_jsx("h4", { className: "font-semibold mb-2 text-[var(--color-brand)]", children: t('sidebar.activities') }), _jsxs("div", { className: "space-y-2", children: [stop.activities.length === 0 && (_jsx("div", { className: "text-sm text-[var(--color-muted)]", children: t('sidebar.none') })), stop.activities.map(function (a) { return (_jsxs("div", { className: "rounded-xl border border-[var(--color-border)] p-3 bg-neutral-50 shadow-sm", children: [_jsx("input", { className: "w-full px-3 py-2 rounded-lg border border-[var(--color-border)] mb-2 bg-white", value: a.title, onChange: function (e) { return setActivityField(stop.id, a.id, 'title', e.target.value); } }), _jsxs("div", { className: "flex items-center gap-2 mb-2", children: [_jsxs("select", { className: "px-3 py-2 rounded-lg border border-[var(--color-border)] bg-white", value: a.category, onChange: function (e) { return setActivityField(stop.id, a.id, 'category', e.target.value); }, children: [_jsx("option", { value: "nature", children: t('sidebar.category.nature') }), _jsx("option", { value: "food", children: t('sidebar.category.food') }), _jsx("option", { value: "culture", children: t('sidebar.category.culture') }), _jsx("option", { value: "nightlife", children: t('sidebar.category.nightlife') }), _jsx("option", { value: "other", children: t('sidebar.category.other') })] }), _jsx("input", { className: "flex-1 px-3 py-2 rounded-lg border border-[var(--color-border)] bg-white", placeholder: t('sidebar.note'), value: a.note || '', onChange: function (e) { return setActivityField(stop.id, a.id, 'note', e.target.value); } })] }), _jsxs("label", { className: "inline-flex items-center gap-2 px-2 py-2 rounded-lg border border-[var(--color-border)] bg-white", children: [_jsx("span", { children: t('sidebar.cost') }), _jsx("input", { type: "number", inputMode: "decimal", step: "any", min: 0, className: "w-28 bg-transparent outline-none", value: a.cost || 0, onFocus: function (e) { return e.currentTarget.select(); }, onChange: function (e) {
                                                                    return setActivityField(stop.id, a.id, 'cost', Number(e.target.value) || 0);
                                                                } })] }), _jsx(EmojiButton, { emoji: "\uD83D\uDDD1", label: t('sidebar.delete'), title: t('sidebar.delete'), onClick: function () { return deleteActivity(stop.id, a.id); }, variant: "btn", className: "ml-2 !bg-red-600 hover:!bg-red-700 border-red-600" })] }, a.id)); }), _jsx(EmojiButton, { emoji: "\u2795", label: t('sidebar.addActivity'), title: t('sidebar.addActivity'), onClick: function () { return addActivity(stop.id); }, variant: "btn" })] })] }), _jsxs("section", { className: "space-y-2", children: [_jsx("h4", { className: "font-semibold text-[var(--color-brand)]", children: t('sidebar.lodgingFoodOther') }), (function () {
                                        var nights = stop.stayNights || 0;
                                        var b = stop.budget || {};
                                        var lodgingTotal = typeof b.lodgingTotal === 'number'
                                            ? b.lodgingTotal
                                            : (b.lodgingPerNight || 0) * nights;
                                        return (_jsxs("div", { className: "grid grid-cols-1 sm:grid-cols-3 gap-2", children: [_jsx(Field, { label: t('sidebar.lodgingTotal'), children: _jsx("input", { type: "number", inputMode: "decimal", step: "any", min: 0, className: "w-full px-3 py-2 rounded-lg border border-[var(--color-border)] bg-white", value: lodgingTotal, onFocus: function (e) { return e.currentTarget.select(); }, onChange: function (e) {
                                                            return setStopField(stop.id, 'budget', __assign(__assign({}, b), { lodgingTotal: Number(e.target.value) || 0 }));
                                                        } }) }), _jsx(Field, { label: t('sidebar.foodPerDay'), children: _jsx("input", { type: "number", inputMode: "decimal", step: "any", min: 0, className: "w-full px-3 py-2 rounded-lg border border-[var(--color-border)] bg-white", value: b.foodPerDay || 0, onFocus: function (e) { return e.currentTarget.select(); }, onChange: function (e) {
                                                            return setStopField(stop.id, 'budget', __assign(__assign({}, b), { foodPerDay: Number(e.target.value) || 0 }));
                                                        } }) }), _jsx(Field, { label: t('sidebar.otherTotal'), children: _jsx("input", { type: "number", inputMode: "decimal", step: "any", min: 0, className: "w-full px-3 py-2 rounded-lg border border-[var(--color-border)] bg-white", value: b.other || 0, onFocus: function (e) { return e.currentTarget.select(); }, onChange: function (e) {
                                                            return setStopField(stop.id, 'budget', __assign(__assign({}, b), { other: Number(e.target.value) || 0 }));
                                                        } }) })] }));
                                    })()] })] }))] })] }));
}
